const geoHubObj = {
"Greater WDC": "Serving the Washington Metro Area & All Surrounding Cities",
"Greater Seattle":
"Serving the Entire Puget Sound Region & Surrounding Areas",
"Greater San Antonio":
"Serving the Greater San Antonio Area & All Surrounding Cities",
"Greater DFW":
"Serving the Dallas-Fort Worth Metroplex & All Surrounding Areas",
"Greater Philadelphia":
"Serving the Greater Philadelphia Area & All Surrounding Cities",
"Greater Cleveland":
"Serving the Greater Cleveland Area & All Surrounding Cities",
"Greater Akron": "Serving the Greater Akron Area & All Surrounding Cities",
"Greater Denver": "Serving the Denver Metro Area & All Surrounding Cities",
"South Florida": "Serving South Florida & All Surrounding Areas",
"Greater Detroit":
"Serving the Detroit Metro Area & All Surrounding Cities",
"Greater Ann Arbor": "Serving Greater Ann Arbor",
"Greater St Louis":
"Serving the Greater St. Louis  Area & All Surrounding Cities",
"The Space Coast Area": "Serving the Space Coast & All Surrounding Areas",
"Southern California":
"Serving Southern California & All Surrounding Areas",
"Orange County": "Serving All of Orange County",
"San Fernando Valley":
"Serving the San Fernando Valey And All Surrounding Areas",
"West Los Angeles":
"Serving West LA The South Bay And All Surrounding Areas",
"San Gabriel Valley":
"Serving the San Gabriel Valley And All Surrounding Areas",
"The Inland Empire": "Servng the Inland Empire And All Surrounding Areas",
"The Piedmont Triad": "Serving The Piedmont Triad & All Surrounding Areas",
"Greater Atlanta": "Serving Metro Atlanta & All Surrounding Areas",
"Greater Orlando": "Serving Greater Orlando & All Surrounding Areas",
"Greater Baltimore":
"Serving the Greater Baltimore Area & All Surrounding Cities",
"Greater Pittsburgh":
"Serving the Greater Pittsburgh Area & All Surrounding Cities",
"Greater Portland": "Serving Greater Portland & All Surrounding Areas",
"Greater Austin":
"Serving the Greater Austin Area & All Surrounding Cities",
"Greater Cincinatti":
"Serving the Greater Cincinnati Area & All Surrounding Cities",
"Greater Dayton":
"Serving the Greater Dayton Area & All Surrounding Cities",
"Greater Tucson": "Serving the Tucson Metro Area & All Surrounding Cities",
"Greater Fresno": "Serving the Fresno Metro Area & All Surrounding Cities",
"Greater Phoenix":
"Serving Metro Phoenix & All Surrounding Areas - In Home And Online",
"the Greater Twin Cities":
"Serving the Twin Cities Area & All Surrounding Cities",
"Greater Columbus":
"Serving the Greater Columbus Area & All Surrounding Cities",
"San Diego County":
"Serving San Diego County from Oceanside to Chula Vista",
"The Bay Area": "Serving The Entire Bay Area & All Surrounding Cities",
"The Peninsula": "Serving the Peninsula And the Rest of the Bay Area",
"The South Bay": "Serving the South Bay And the Rest of the Bay Area",
"The East Bay": "Serving the East Bay And The Rest of the Bay Area",
"Greater Bakersfield":
"Serving Greater Bakersfield & All Surrounding Areas",
"Greater Las Vegas": "Serving Greater Las Vegas & All Surrounding Areas",
"Greater Charlotte":
"Serving the Charlotte Metro Area & All Surrounding Cities",
"Greater Houston":
"Serving the Greater Houston Area & All Surrounding Cities",
"Greater NYC": "Serving NYC & All Surrounding Areas",
Manhattan:
"Serving Manhattan & the rest of New York City - In Home And Online",
Queens: "Serving Queens & the Rest of New York City - In Home And Online",
Brooklyn:
"Serving Brooklyn & the Rest of New York City - In Home And Online",
"Staten Island":
"Serving Staten Island & the rest of New York City - In Home And Online",
"The Bronx":
"Serving The Bronx & the rest of New York City - In Home And Online",
"Long Island":
"Serving Long Island & surrounding areas - In Home And Online",
"Westchester County":
"Serving Westchester County And All Surrounding Areas",
"Greater Virginia Beach":
"Serving the Greater Hampton Roads Area & All Surrounding Cities",
"Greater Richmond":
"Serving the Richmond Metro Area & All Surrounding Cities",
"SLO County": "Serving All of SLO County",
"Greater Santa Barbara": "Serving Santa Barbara & All Surrounding Areas",
"Ventura County": "Serving All of Ventura County",
"Greater Tampa Bay":
"Serving the Greater Tampa Bay Area & All Surrounding Cities",
"Greater Kansas City":
"Serving the Kansas City Metro Area & All Surrounding Cities",
"Greater Jacksonville":
"Serving the Jacksonville Metro Area & All Surrounding Cities",
"Greater Sacramento": "Serving Greater Sacramento & All Surrounding Areas",
"The Research Triangle":
"Serving the Research Triangle & All Surrounding Cities",
"The Sarasota Metro Area":
"Serving the Sarasota Metro Area & All Surrounding Cities",
"The Mahoning Valley":
"Serving the Mahoning Valley & All Surrounding Cities",
"Salt Lake City":
"Serving the Entire Wasatch Front & All Surrounding Areas",
Louisville: "Serving Greater Louisville & All Surrounding Areas",
Birmingham: "Serving Greater Birmingham & All Surrounding Areas",
"Oklahoma City": "Serving Greater Oklahoma City & All Surrounding Areas",
Milwaukee: "Serving Greater Milwaukee & All Surrounding Areas",
Providence: "Serving Greater Providence & All Surrounding Areas",
Nashville: "Serving Greater Nashville & All Surrounding Areas",
Indianapolis: "Serving Greater Indianapolis & All Surrounding Areas",
"New Orleans": "Serving Greater New Orleans & All Surrounding Areas",
"Baton Rouge": "Serving Greater Baton Rouge & All Surrounding Areas",
Lafayette: "Serving Greater Lafayette & All Surrounding Areas",
Greenville: "Serving Upstate South Carolina & All Surrounding Areas",
Hartford: "Serving Greater Hartford & All Surrounding Areas",
"Grand Rapids": "Serving Greater Grand Rapids & All Surrounding Areas",
Memphis: "Serving Greater Memphis & All Surrounding Areas",
"Buffalo-Niagara Falls":
"Serving the Buffalo-Niagara Region & All Surrounding Areas",
"The Capital Region": "Serving The Capital Region & All Surrounding Areas",
Rochester: "Serving Greater Rochester & All Surrounding Areas",
"Albuquerque and Santa Fe":
"Serving Albuquerque, Santa Fe & All Surrounding Areas",
Knoxville: "Serving Greater Knoxville & All Surrounding Areas",
Chattanooga: "Serving Greater Chattanooga & All Surrounding Areas",
Tulsa: "Serving Greater Tulsa & All Surrounding Areas",
"El Paso": "Serving Greater El Paso & All Surrounding Areas",
Honolulu: "Serving Greater Honolulu & Surrounding Areas",
"Central Arkansas": "Serving Littlerock Metro & All Surrounding Areas",
Boise: "Serving The Treasure Valley & All Surrounding Areas",
"Fairfield County": "Serving Fairfield County & All Surrounding Areas",
"Fort Wayne": "Serving Greater Fort Wayne & All Surrounding Areas",
Madison: "Serving Greater Madison & All Surrounding Areas",
"Green Bay": "Serving Greater Green Bay & All Surrounding Areas",
"The Tri-County Area": "Serving Greater Charleston & All Surrounding Areas",
Columbia: "Serving Greater Columbia & All Surrounding Areas",
"Myrtle Beach": "Serving Greater Myrtle Beach & All Surrounding Areas",
"New Haven County": "Serving New Haven County And All Surrounding Areas",
"The Hudson Valley": "Serving The Hudson Valley And All Surrounding Areas",
Syracuse: "Serving Greater Syracuse & All Surrounding Areas",
"The Lehigh Valley": "Serving The Lehigh Valley & All Surrounding Areas",
"Dauphin County": "Serving Dauphin County And All Surrounding Areas",
"Berks County": "Serving Berks County & All Surrounding Areas",
"The Wyoming Valley": "Serving The Wyoming Valley & All Surrounding Areas",
"York County": "Serving York County & All Surrounding Areas",
"Lancaster County": "Serving Lancaster County & All Surrounding Areas",
Augusta: "Serving Greater Augusta & All Surrounding Areas",
"Lexington-Fayette": "Serving Greater Lexington & All Surrounding Areas",
Pensacola: "Serving Greater Pensacola & All Surrounding Areas",
Savannah: "Serving Greater Savannah & All Surrounding Areas",
"Central Michigan": "Serving Greater Lansing & All Surrounding Areas",
"Hillsborough County":
"Serving Hillsborough County & All Surrounding Areas",
"Greater Portland": "Serving Greater Portland & All Surrounding Areas",
Salisbury: "Serving Greater Salisbury & All Surrounding Areas",
"Corpus Christi": "Serving Greater Corpus Christi & All Surrounding Areas",
"Killeen-Temple-Fort Hood":
"Serving The Centroplex & All Surrounding Areas",
"Hidalgo County": "Serving Hidalgo County & All Surrounding Areas",
Omaha: "Serving Greater Omaha & All Surrounding Areas",
Springfield: "Serving Greater Springfield & All Surrounding Areas",
Wichita: "Serving Greater Wichita & All Surrounding Areas",
"Des Moines": "Serving Greater Des Moine And All Surrounding Areas",
"Northwest Arkansas": "Serving Northwest Arkansas & All Surrounding Areas",
"Gulfport-Biloxi": "Serving the Gulf Coast & All Surrounding Areas",
Huntsville: "Serving Greater Huntsville & All Surrounding Areas",
Jackson: "Serving Greater Jackson & All Surrounding Areas",
Mobile: "Serving Greater Mobile & All Surrounding Areas",
Reno: "Serving Greater Reno & All Surrounding Areas",
"Monterey County": "Serving Monterey County & All Surrounding Cities",
Spokane: "Serving Greater Spokane & All Surrounding Areas",
"The DC Metro":
"Serving the Washington Metro Area And All Surrounding Cities",
};

const geoNumObj = {
"(805) 548-8867": "<span>(805) 548-8867</span>",
"(805) 968-8867": "<span>(805) 968-8867</span>",
"(619) 578-8867": "<span>(619) 578-8867</span>",
"(714) 558-8867": "<span>(714) 558-8867</span>",
"(818) 358-8867": "<span>(818) 358-8867</span>",
"(626) 338-8867": "<span>(626) 338-8867</span>",
"(562) 438-8867": "<span>(562) 438-8867</span>",
"(310) 338-8867": "<span>(310) 338-8867</span>",
"(909) 338-8867": "<span>(909) 338-8867</span>",
"(415) 788-8867": "<span>(415) 788-8867</span>",
"(650) 968-8867": "<span>(650) 968-8867</span>",
"(408) 448-8867": "<span>(408) 448-8867</span>",
"(925) 458-8867": "<span>(925) 458-8867</span>",
"(916) 448-8867": "<span>(916) 448-8867</span>",
"(206) 448-8867": "<span>(206) 448-8867</span>",
"(503) 238-8867": "<span>(503) 238-8867</span>",
"(702) 658-8867": "<span>(702) 658-8867</span>",
"(303) 338-8867": "<span>(303) 338-8867</span>",
"(602) 788-8867": "<span>(602) 788-8867</span>",
"(520) 458-8867": "<span>(520) 458-8867</span>",
"(214) 328-8867": "<span>(214) 328-8867</span>",
"(713) 228-8867": "<span>(713) 228-8867</span>",
"(512) 458-8867": "<span>(512) 458-8867</span>",
"(210) 558-8867": "<span>(210) 558-8867</span>",
"(651) 578-8867": "<span>(651) 578-8867</span>",
"(913) 498-8867": "<span>(913) 498-8867</span>",
"(314) 878-8867": "<span>(314) 878-8867</span>",
"(202) 408-8867": "<span>(202) 408-8867</span>",
"(410) 358-8867": "<span>(410) 358-8867</span>",
"(215) 338-8867": "<span>(215) 338-8867</span>",
"(305) 448-8867": "<span>(305) 448-8867</span>",
"(404) 248-8867": "<span>(404) 248-8867</span>",
"(212) 568-8867": "<span>(212) 568-8867</span>",
"(718) 338-8867": "<span>(718) 338-8867</span>",
"(914) 448-8867": "<span>(914) 448-8867</span>",
"(646) 224-0716": "<span>(646) 224-0716</span>",
"(917) 444-5901": "<span>(917) 444-5901</span>",
"(516) 358-8867": "<span>(516) 358-8867</span>",
"(813) 968-8867": "<span>(813) 968-8867</span>",
"(407) 328-8867": "<span>(407) 328-8867</span>",
"(313) 568-8867": "<span>(313) 568-8867</span>",
"(734) 848-8867": "<span>(734) 848-8867</span>",
"(757) 468-8867": "<span>(757) 468-8867</span>",
"(804) 358-8867": "<span>(804) 358-8867</span>",
"(412) 678-8867": "<span>(412) 678-8867</span>",
"(559) 438-8867": "<span>(559) 438-8867</span>",
"(661) 328-8867": "<span>(661) 328-8867</span>",
"(904) 448-8867": "<span>(904) 448-8867</span>",
"(216) 268-8867": "<span>(216) 268-8867</span>",
"(513) 598-8867": "<span>(513) 598-8867</span>",
"(614) 258-8867": "<span>(614) 258-8867</span>",
"(937) 548-8867": "<span>(937) 548-8867</span>",
"(704) 568-8867": "<span>(704) 568-8867</span>",
"(919) 558-8867": "<span>(919) 558-8867</span>",
"(336) 358-8867": "<span>(336) 358-8867</span>",
"(888) 520-0495": "<span>(888) 520-0495</span>",
"(801) 908-8867": "<span>(801) 908-8867</span>",
"(502) 487-2700": "<span>(502) 487-2700</span>",
"(205) 677-3030": "<span>(205) 677-3030</span>",
"(405) 458-4600": "<span>(405) 458-4600</span>",
"(414) 616-7950": "<span>(414) 616-7950</span>",
"(401) 542-2900": "<span>(401) 542-2900</span>",
"(615) 640-6700": "<span>(615) 640-6700</span>",
"(765) 344-4100": "<span>(765) 344-4100</span>",
"(504) 457-7400": "<span>(504) 457-7400</span>",
"(225) 283-4700": "<span>(225) 283-4700</span>",
"(337) 346-6100": "<span>(337) 346-6100</span>",
"(864) 565-7700": "<span>(864) 565-7700</span>",
"(860) 458-4100": "<span>(860) 458-4100</span>",
"(616) 344-1313": "<span>(616) 344-1313</span>",
"(901) 545-5800": "<span>(901) 545-5800</span>",
"(716) 324-5700": "<span>(716) 324-5700</span>",
"(518) 539-6767": "<span>(518) 539-6767</span>",
"(585) 531-3200": "<span>(585) 531-3200</span>",
"(505) 317-6400": "<span>(505) 317-6400</span>",
"(865) 294-8900": "<span>(865) 294-8900</span>",
"(423) 375-9700": "<span>(423) 375-9700</span>",
"(918) 621-0410": "<span>(918) 621-0410</span>",
"(915) 519-4500": "<span>(915) 519-4500</span>",
"(808) 900-7312": "<span>(808) 900-7312</span>",
"(501) 387-0177": "<span>(501) 387-0177</span>",
"(208) 338-8867": "<span>(208) 338-8867</span>",
"(203) 780-0288": "<span>(203) 780-0288</span>",
"(260) 245-2100": "<span>(260) 245-2100</span>",
"(608) 573-3035": "<span>(608) 573-3035</span>",
"(920) 306-5707": "<span>(920) 306-5707</span>",
"(843) 823-3600": "<span>(843) 823-3600</span>",
"(803) 620-4700": "<span>(803) 620-4700</span>",
"(845) 407-0101": "<span>(845) 407-0101</span>",
"(315) 922-1300": "<span>(315) 922-1300</span>",
"(610) 750-9850": "<span>(610) 750-9850</span>",
"(717) 467-7700": "<span>(717) 467-7700</span>",
"(570) 526-1890": "<span>(570) 526-1890</span>",
"(706) 620-0202": "<span>(706) 620-0202</span>",
"(859) 982-3900": "<span>(859) 982-3900</span>",
"(850) 601-5200": "<span>(850) 601-5200</span>",
"(912) 358-2600": "<span>(912) 358-2600</span>",
"(517) 798-6880": "<span>(517) 798-6880</span>",
"(603) 509-5095": "<span>(603) 509-5095</span>",
"(207) 512-4900": "<span>(207) 512-4900</span>",
"(361) 317-2922": "<span>(361) 317-2922</span>",
"(254) 304-9100": "<span>(254) 304-9100</span>",
"(956) 489-5500": "<span>(956) 489-5500</span>",
"(402) 519-4900": "<span>(402) 519-4900</span>",
"(417) 258-8400": "<span>(417) 258-8400</span>",
"(316) 512-1370": "<span>(316) 512-1370</span>",
"(515) 635-1305": "<span>(515) 635-1305</span>",
"(479) 339-9400": "<span>(479) 339-9400</span>",
"(228) 325-1955": "<span>(228) 325-1955</span>",
"(256) 474-3477": "<span>(256) 474-3477</span>",
"(601) 476-4967": "<span>(601) 476-4967</span>",
"(251) 415-5252": "<span>(251) 415-5252</span>",
"(775) 372-6694": "<span>(775) 372-6694</span>",
"(831) 275-3200": "<span>(831) 275-3200</span>",
"(509) 381-2162": "<span>(509) 381-2162</span>",
};


const urlParams = new URLSearchParams(window.location.search);
let getGeoHub = urlParams.get("geoHub");
let getGeoNum = urlParams.get("geoNum");
let city_replace = document.getElementsByClassName("city-replace");
let num_replace = document.getElementsByClassName("number-replace");
let multi_num_replace = document.getElementsByClassName(
"multi-number-replace"
);
let geophrase_replace = document.getElementsByClassName("geophrase");
let getValueTrack = urlParams.get("loc"); // URL Parameter key
let getSource = urlParams.get("utm_source"); // URL Parameter key
let getNetwork = urlParams.get("network"); // URL Parameter key

if (getValueTrack) {
function runBeforeResponseTap() {
try {
  const locationApiPromise = fetch(
    "https://location-api.gradepotentialtutoring.com/api/location/" +
      getValueTrack +
      "?source=" +
      (getSource ? getSource : "google") +
      "&network=" +
      (getNetwork ? getNetwork : "search")
  )
    .then((response) => {
      return response.json();
    })
    .then((data) => {
      let default_numbers = data.defaultNumber;
      let city_name = data.location.name;
      let loc_type = data.location.type;

      let formatPhoneNumber = (str) => {
        //Filter only numbers from the input
        let cleaned = ("" + str).replace(/\D/g, "");

        //Check if the input is of correct length
        let match = cleaned.match(/^(\d{3})(\d{3})(\d{4})$/);

        if (match) {
          return "(" + match[1] + ") " + match[2] + "-" + match[3];
        }

        return null;
      };

      for (var i = 0; i < num_replace.length; i++) {
        if (default_numbers[0] == "8885200511") {
          num_replace[i].innerHTML =
            '<span class="label">' + getGeoNum + "</span>";
        } else {
          num_replace[i].innerHTML =
            '<span class="label">' +
            formatPhoneNumber(default_numbers[0]) +
            "</span>";
        }
      }

      multi_num(default_numbers, formatPhoneNumber);
      geophrase();

      if (
        [
          "Postal Code",
          "Congressional District",
          "State",
          "Country",
        ].indexOf(loc_type) == -1
      ) {
        for (var i = 0; i < city_replace.length; i++) {
          city_replace[i].innerHTML = city_name;
        }
      } else {
        city();
      }
    });

  const timerPromise = new Promise((resolve) => {
    setTimeout(() => resolve(), 5000);
  });
  return Promise.race([locationApiPromise, timerPromise])
    .then(() => setHeaderVisible())
    .catch((error) => {
      setHeaderVisible();
    });
  setHeaderVisible();
  return Promise.resolve();
} catch (err) {
  setHeaderVisible();
}
}
} else {
function runBeforeResponseTap() {
try {
  num();
  multi_num();
  geophrase();
  city();
  setHeaderVisible();
} catch (err) {
  setHeaderVisible();
}
}
}

function num() {
for (var i = 0; i < num_replace.length; i++) {
if (getGeoNum) {
  num_replace[i].innerHTML =
    '<span class="label">' + getGeoNum + "</span>";
} else {
  num_replace[i].innerHTML = "(888) 520-0511";
}
}
}
function multi_num(default_numbers, formatPhoneNumber) {
for (var i = 0; i < multi_num_replace.length; i++) {
if (getGeoNum && geoNumObj[getGeoNum] !== undefined) {
  multi_num_replace[i].innerHTML = geoNumObj[getGeoNum];
} else if (getGeoNum && geoNumObj[getGeoNum] === undefined) {
  multi_num_replace[i].innerHTML = getGeoNum;
} else if (!getGeoNum && getValueTrack) {
  multi_num_replace[i].innerHTML =
    '<span class="label">' +
    formatPhoneNumber(default_numbers[0]) +
    "</span>";
} else {
  multi_num_replace[i].innerHTML = "(888) 520-0511";
}
}
}
function geophrase() {
for (var i = 0; i < geophrase_replace.length; i++) {
if (getGeoHub && geoHubObj[getGeoHub] !== undefined) {
  geophrase_replace[i].innerHTML = geoHubObj[getGeoHub];
} else {
  geophrase_replace[i].innerHTML =
    "We Tutor All Subjects & Grade Levels - In Home And Online";
}
}
}
function city() {
for (var i = 0; i < city_replace.length; i++) {
if (urlParams.get("kw2")) {
  city_replace[i].innerHTML = urlParams.get("kw2").replace("-", " ");
} else if (getGeoHub) {
  city_replace[i].innerHTML = getGeoHub.replace("-", " ");
} else {
  city_replace[i].innerHTML = "Your Neighborhood";
}
}
}
function setHeaderVisible() {
const boxes = document.querySelectorAll(".visibility-toggle");
for (const box of boxes) {
box.classList.add("visible");
}
}